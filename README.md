{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "d5788c3f",
   "metadata": {
    "vscode": {
     "languageId": "markdown"
    }
   },
   "source": [
    "# README\n",
    "# GNN_MODEL_TRPM8_DRUG_POTENCY_PREDICTION\n",
    "\n",
    "Predict TRPM8 ligand potency (classification & pCHEMBL (-LogIC50) regression) using Graph Neural Networks.\n",
    "\n",
    "---\n",
    "\n",
    "## ğŸš€ Project Overview\n",
    "\n",
    "The goal of this project is to predict the potency of small-molecule ligands against the TRPM8 ion channel from ChEMBL, by learning directly on their molecular graph representations. We tackle two complementary tasks:\n",
    "\n",
    "1. **Potency classification**  \n",
    "   â€” Bin each compound into **Low / Medium / High** potency classes.  \n",
    "\n",
    "2. **pCHEMBL (-LogIC50) regression**  \n",
    "   â€” Predict continuous pChEMBL (â€“logâ‚â‚€ ICâ‚…â‚€) values.  \n",
    "\n",
    "We compare five popular GNN architectures (GIN, GCN, MPNN, GraphSAGE, GAT) in a fully automated pipeline that:\n",
    "\n",
    "1. **Prepares raw data**  \n",
    "   Cleans TRPM8 activity measurements.  \n",
    "2. **Extracts graph features**  \n",
    "   Generates atom- and bond-level descriptors (e.g. partial charges, hybridization, one-hot atom types).  \n",
    "3. **Builds PyG datasets**  \n",
    "   Converts SMILES â†’ PyTorch-Geometric Data objects for both tasks.  \n",
    "4. **Splits & cross-validates**  \n",
    "   Performs stratified 10-fold CV for classification and random 10-fold CV for regression.  \n",
    "5. **Trains & tunes**  \n",
    "   Sweeps hidden dimensions, dropout rates, and learning rates; uses early stopping and LR schedulers.  \n",
    "6. **Ensembles & finalizes**  \n",
    "   Averages fold predictions on the held-out test set and retrains a single final model on all train+val data.  \n",
    "7. **Baselines & comparisons**  \n",
    "   Benchmarks against classical QSAR models via bar and radar plots.\n",
    "\n",
    "```\n",
    " ## ğŸ“‚ Repository Structure\n",
    "\n",
    "GNN_MODEL_TRPM8_DRUG_POTENCY_PREDICTION/\n",
    "â”œâ”€â”€ 1_data/\n",
    "â”‚   â”œâ”€â”€ initial_data/\n",
    "â”‚   â”‚   â”œâ”€â”€ orca_outputs/\n",
    "â”‚   â”‚   â””â”€â”€ Pre-process.ipynb\n",
    "â”‚   â””â”€â”€ processed/\n",
    "â”‚       â”œâ”€â”€ .gitkeep\n",
    "â”‚       â”œâ”€â”€ TRPM8_cleaned_preprocessed.csv\n",
    "â”‚       â”œâ”€â”€ TRPM8_graph_classification.csv\n",
    "â”‚       â””â”€â”€ TRPM8_graph_regression.csv\n",
    "â”œâ”€â”€ 2_feature_extraction/\n",
    "â”‚   â”œâ”€â”€ .gitkeep\n",
    "â”‚   â”œâ”€â”€ Feature_extraction.ipynb\n",
    "â”‚   â”œâ”€â”€ mulliken_charges.json\n",
    "â”‚   â”œâ”€â”€ TRPM8_graph_features_class_w_atomic_onehot_encoder.csv\n",
    "â”‚   â””â”€â”€ TRPM8_graph_features_regression_w_atomic_onehot_encoder.csv\n",
    "â”œâ”€â”€ 3_graph_data/\n",
    "â”‚   â”œâ”€â”€ .gitkeep\n",
    "â”‚   â”œâ”€â”€ GraphDataset_conversion_for_PyTorch_Geometric.ipynb\n",
    "â”‚   â”œâ”€â”€ TRPM8_classification_graph_dataset.pt\n",
    "â”‚   â””â”€â”€ TRPM8_regression_graph_dataset.pt\n",
    "â”œâ”€â”€ 4_train_test_split/\n",
    "â”‚   â”œâ”€â”€ 10fold_cv/\n",
    "â”‚   |   â”œâ”€â”€ classification\n",
    "â”‚   |   â”œâ”€â”€ regression\n",
    "â”‚   â”œâ”€â”€ .gitkeep\n",
    "â”‚   â””â”€â”€ Graph_dataset_train_test_val_random_split_and_Kfoldsplit.ipynb\n",
    "â”œâ”€â”€ 5_model_training/\n",
    "â”‚   â”œâ”€â”€ GAT/\n",
    "â”‚   â”‚   â”œâ”€â”€ classification_10fold/\n",
    "â”‚   â”‚   â”œâ”€â”€ regression_10fold/\n",
    "â”‚   â”‚   â”œâ”€â”€ Final_GAT_training_classification.ipynb\n",
    "â”‚   â”‚   â””â”€â”€ Final_GAT_training_regression.ipynb\n",
    "â”‚   â”œâ”€â”€ GCN/\n",
    "â”‚   â”‚   â”œâ”€â”€ classification_10fold/\n",
    "â”‚   â”‚   â”œâ”€â”€ regression_10fold/\n",
    "â”‚   â”‚   â”œâ”€â”€ Final_GCN_training_classification.ipynb\n",
    "â”‚   â”‚   â””â”€â”€ Final_GCN_training_regression.ipynb\n",
    "â”‚   â”œâ”€â”€ GIN/\n",
    "â”‚   â”‚   â”œâ”€â”€ classification_10fold/\n",
    "â”‚   â”‚   â”œâ”€â”€ regression_10fold/\n",
    "â”‚   â”‚   â”œâ”€â”€ Final_GIN_training_classification.ipynb\n",
    "â”‚   â”‚   â””â”€â”€ Final_GIN_training_regression.ipynb\n",
    "â”‚   â”œâ”€â”€ GraphSAGE/\n",
    "â”‚   â”‚   â”œâ”€â”€ classification_10fold/\n",
    "â”‚   â”‚   â”œâ”€â”€ regression_10fold/\n",
    "â”‚   â”‚   â”œâ”€â”€ Final_GraphSAGE_training_classification.ipynb\n",
    "â”‚   â”‚   â””â”€â”€ Final_GraphSAGE_training_regression.ipynb\n",
    "â”‚   â””â”€â”€ MPNN/\n",
    "â”‚       â”œâ”€â”€ classification_10fold/\n",
    "â”‚       â”œâ”€â”€ regression_10fold/\n",
    "â”‚       â”œâ”€â”€ Final_MPNN_training_classification.ipynb\n",
    "â”‚       â””â”€â”€ Final_MPNN_training_regression.ipynb\n",
    "â”œâ”€â”€ 6_baseline/\n",
    "â”‚   â”œâ”€â”€ QSAR_classification_performance_summary.csv\n",
    "â”‚   â””â”€â”€ QSAR_regression_performance_summary.csv\n",
    "â”‚   â””â”€â”€ GNN_vs_QSAR_comparison.ipynb\n",
    "â””â”€â”€ README.md\n",
    "\n",
    "```\n",
    "USAGE\n",
    "\n",
    "Run end-to-end\n",
    "\n",
    "Step 1: preprocess â†’ 1_data/\n",
    "\n",
    "Step 2: extract features â†’ 2_feature_extraction/\n",
    "\n",
    "Step 3: build graphs â†’ 3_graph_data/\n",
    "\n",
    "Step 4: split data â†’ 4_train_test_split/\n",
    "\n",
    "Step 5: train & tune â†’ 5_model_training/<ARCH>/â€¦\n",
    "\n",
    "Step 6: ensemble & final evaluate â†’ notebooks in notebooks/\n",
    "\n",
    "Step 7: baseline comparison â†’ 6_baseline/\n",
    "\n",
    "## Inspect results\n",
    "\n",
    "Fold metrics, confusion matrices & AUC-ROC (classification)\n",
    "\n",
    "MAE/MSE/RMSE/RÂ² curves & scatter plots (regression)\n",
    "\n",
    "Bar & radar plots vs. baseline QSAR\n",
    "\n",
    "\n",
    "\n",
    "\n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python (myenv)",
   "language": "python",
   "name": "myenv"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
